{% extends 'base.html.twig' %}

{% block title %}PROSmobile - Articles{% endblock %}

{% block body %}
    {# tree #}
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb bg-white rounded-0">
            <li class="breadcrumb-item">
                {% if is_granted('ROLE_ADMIN') %}
                    <a href="{{ path('admin_index') }}">
                        Dashboard
                    </a>
                {% else %}
                    <a href="{{ path('home') }}">
                        Accueil
                    </a>
                {% endif %}
            </li>
            <li class="breadcrumb-item active" aria-current="page">
                Articles
            </li>
        </ol>
    </nav>
    {# title #}
    <h1>Tous les articles disponibles</h1>
    {# add button #}
        <div class="container-fluid mt-4">
            <div class="row">
                <button class="btn" title="Ajouter">
                    <a href="{{ path('article_new') }}">
                        <i data-fa-symbol="add" class="fas fa-plus text-secondary"></i>
                        <svg class="icon-md">
                            <use xlink:href="#add"></use>
                        </svg>
                    </a>
                </button>
            </div>
        </div>
    {# product list #}
    <div class="container mt-4">
        <div class="row">
            {% for article in articles %}
                {% if article.photo is empty %}
                    {% set photo ='' %}
                {% else %}
                    {% set photo = article.photo %}
                {% endif %}
                <div class="col-4 mt-2" style="height:300px;">
                    <div class="media mt-2">
                        <img src="{{ photo }}" class="align-self-start mr-4 img-thumbnail" style="width:150px; height:200px;" alt="...">
                        <div class="media-body">
                            <h5 class="mt-2">{{ article.nom }}</h5>
                                <p class="card-text">
                                    Référence :
                                    {{ article.reference }}
                                </p>
                                <p class="card-text">
                                    Stock restant :
                                    {{ article.stock }}
                                </p>
                            <p class="card-text">
                                {{ article.description }}
                            </p>
                            {% if promo is defined and not null %}
                                <p class="card-text">
                                    <del>{{ article.prixTtc }}</del>
                                    €
                                </p>
                                <p class="card-text">
                                    {% set prixTTcReduit = article.prixTtc * (1 - promo / 100) %} promotion : {{ prixTTcReduit }}
                                    € TTC
                                </p>
                            {% else %}
                                <p class="card-text">
                                    {{ article.prixTtc }}
                                    € TTC
                                </p>
                            {% endif %}
                                    <p class="card-text">
                                        {{ article.prixHt }}
                                        € HT
                                    </p>
                            {# buttons #}
                            <div class="container">
                                <div class="row">
                                    {# show product button #}
                                    <div class="col-4">
                                        <button class="btn" title="Afficher">
                                           <a href="{{ path('article_show', {'slug1': article.typeArt.nom, 'slug2': article.marque.nom, 'id': article.id }) }}">
                                                <i data-fa-symbol="show" class="fas fa-eye text-secondary"></i>
                                                <svg class="icon-md">
                                                    <use xlink:href="#show"></use>
                                                </svg>
                                            </a>
                                        </button>
                                    </div>
                                        {# edit button #}
                                        <div class="col-4">
                                            <button class="btn" title="Modifier">
                                                <a href="{{ path('article_edit', {'id': article.id}) }}">
                                                    <i data-fa-symbol="edit" class="fas fa-pen text-secondary"></i>
                                                    <svg class="icon-md">
                                                        <use xlink:href="#edit"></use>
                                                    </svg>
                                                </a>
                                            </button>
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% else %}
                {# empty #}
                <div>
                    Aucun article n'est enregistré dans cette liste
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}
