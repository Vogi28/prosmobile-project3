<h1 class="text-center">Articles compatibles</h1>
{# compatible product #}
<div class="container mt-4">
	<div class="row">
		{% for art_comp in art_comps %}
			{% if art_comp.photo is empty %}
				{% set photo ='' %}
			{% else %}
				{% set photo = art_comp.photo %}
			{% endif %}
			<div class="col-4 mt-2" style="height:500px;">
				<div class="media mt-2">
					<img src="{{ photo }}" class="align-self-start mr-4 img-thumbnail" style="width:150px; height:200px;" alt="...">
					<div class="media-body">
						<h5 class="mt-2">
							{{ art_comp.nom }}</h5>
						{# administrator part #}
						{% if is_granted('ROLE_ADMIN') %}
							<p class="mt-4">
								Référence : {{ art_comp.reference }}
							</p>
							<p class="mt-4">
								Stock restant : {{ art_comp.stock }}
							</p>
						{% endif %}
						<p class="card-text">
							{{ art_comp.description }}
						</p>
						{# user part #}
						{% if is_granted('ROLE_PRO') == false %}
							{% if promo is defined %}
								<p class="card-text">
									<del>{{ art_comp.prixTtc }}</del> €
								</p>
								<p class="card-text">
									{{ art_comp_TTC_reduit }} € TTC
								</p>
							{% else %}
								<p class="card-text">
									{{ art_comp.prixTtc }} € TTC
								</p>
							{% endif %}
						{% endif %}
						{% if is_granted('ROLE_PRO') %}
							{% if reduc is defined and not null %}
								<p class="card-text">
									<del>{{ art_comp.prixHt }}</del> €
								</p>
								<p class="card-text">
									{{ art_comp_HT_reduit }} € HT
								</p>
							{% else %}
								<p class="card-text">
									{{ art_comp.prixHt }} € HT
								</p>
							{% endif %}
						{% endif %}
						{# buttons #}
						<div class="container">
							<div class="row">
								{# show product button #}
								<div class="col-4">
									<button class="btn" title="Afficher">
										<a href="{{ path('article_show', {'slug1': type_art.nom, 'slug2': marque.nom, 'id': article.id }) }}">
											<i data-fa-symbol="show" class="fas fa-eye text-secondary"></i>
											<svg class="icon-md">
												<use xlink:href="#show"></use>
											</svg>
										</a>
									</button>
								</div>
								{# add to basket button #}
								{# TODO modifier ce qu'il faut dans le bouton ci-dessous #}
										<div class="col-4">
											<button class="btn" title="Ajouter au panier">
												{% if is_granted('ROLE_PRO') and reduc is defined and not null %}
												<a href="{{ path('panier_add', {'id': article.id, 'promo': reduc} )}}">
													{% elseif promo is defined and not null %}
													<a href="{{ path('panier_add', {'id': article.id, 'promo': promo} )}}">
														{% else %}
														<a href="{{ path('panier_add', {'id': article.id, 'promo': 0} )}}">
															{% endif %}
															<i data-fa-symbol="basket" class="fas fa-shopping-cart text-success"></i>
															<svg class="icon-md">
																<use xlink:href="#basket"></use>
															</svg>
														</a>
											</button>
										</div>
								{# administrator part #}
								{% if is_granted('ROLE_ADMIN') %}
									{# edit button #}
									<div class="col-4">
										<button class="btn" title="Modifier">
											<a href="{{ path('article_edit', {'id': article.id}) }}">
												<i data-fa-symbol="edit" class="fas fa-pen text-secondary"></i>
												<svg class="icon-md">
													<use xlink:href="#edit"></use>
												</svg>
											</a>
										</button>
									</div>
								{% endif %}
							</div>
						</div>
					</div>
				</div>
			</div>
		{% else %}
			<div>
				Aucun article compatible enregistré dans cette liste
			</div>
		{% endfor %}
	</div>
</div>
